#
# Telegraf Influxdb Grafana node definition
#

# CAP_AUDIT_WRITE is needed to run sshd in the container

id: tig
configuration:
  generator:
    driver: iosv
  provisioning:
    volume_name: cfg
    media_type: raw
    files:
      - name: config.json
        editable: false
        content: |
          {
            "docker": {
              "image": "frr:10.4",
              "mounts": [
                "type=bind,source=cfg/telegraf.conf,target=/etc/telegraf/telegraf.conf",
                "type=bind,source=cfg/influxdb.conf,target=/etc/influxdb/influxdb.conf",
                "type=bind,source=cfg/supervisord.conf,target=/etc/supervisor/conf.d/supervisord.conf"
              ],
              "caps": [
                "CAP_AUDIT_WRITE",
                "CAP_CHOWN",
                "CAP_DAC_OVERRIDE",
                "CAP_FOWNER",
                "CAP_FSETID",
                "CAP_KILL",
                "CAP_MKNOD",
                "CAP_NET_BIND_SERVICE",
                "CAP_NET_RAW",
                "CAP_SETFCAP",
                "CAP_SETGID",
                "CAP_SETPCAP",
                "CAP_SETUID",
                "CAP_SYS_CHROOT",
                "NET_ADMIN",
                "SYS_ADMIN"
              ],
              "env": [
              ],
              "misc_args": [],
              "run_args": [],
              "extra_args": []
            },
            "shell": "/bin/bash",
            "day0cmd": [ "/bin/bash", "/config/boot.sh" ],
            "busybox": true
          }
      - name: telegraf.conf
        editable: true
        content: |
          # Configuration for telegraf agent
          end
      - name: influxdb.conf
        editable: true
        content: |
          exit 0
      - name: supervisord.conf
        editable: true
        content: |
          # pathd
device:
  interfaces:
    has_loopback_zero: false
    min_count: 1
    default_count: 8
    management:
      - eth0
    physical:
      - eth0
      - eth1
      - eth2
      - eth3
      - eth4
      - eth5
      - eth6
      - eth7
    serial_ports: 2
inherited:
  image:
    ram: true
    cpus: true
    cpu_limit: true
    data_volume: false
    boot_disk_size: false
  node:
    ram: true
    cpus: true
    cpu_limit: true
    data_volume: false
    boot_disk_size: false
general:
  description: Telegraf Influxdb Grafana (Docker)
  nature: router
  read_only: true
schema_version: 0.0.1
sim:
  linux_native:
    cpus: 1
    ram: 256
    driver: server
    libvirt_domain_driver: docker
    cpu_limit: 100
boot:
  timeout: 30
  completed:
    - READY
pyats:
  os: ios
  series: iosv
  config_extract_command: show run
ui:
  description: |
    Telegraf Influxdb Grafana (Docker)
  group: Others
  icon: router
  label: TIG
  label_prefix: tig-
  visible: true